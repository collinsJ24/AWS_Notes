AWS Notes

Availibility zones are 1 or more data centres
----------------------------------------------------------------------------------------------------------------------------------------------------
AWS global services - IAM, DNS, CDN, WAF

AWS region scoped services - EC2, Lambda, elastic beanstalk
----------------------------------------------------------------------------------------------------------------------------------------------------
IAM

users are assigned to policies (Groups)

Best principle is to create an admin group and give it Administrator access, then add a new user account to this.
This means you no longer need to use the root account anymore.

inline policy only applies to one user
----------------------------------------------------------------------------------------------------------------------------------------------------
IAM Roles for Services

Creating Role for AWS service to use, eg. allow an EC2 instance to read from S3 bucket


----------------------------------------------------------------------------------------------------------------------------------------------------
How to access AWS ?

AWS console -> password + MFA
AWS CLI -> Access keys
AWS SDK -> used to access AWS API in your apps -< Access keys

Access keys generated in the console
Users manage their own access keys
----------------------------------------------------------------------------------------------------------------------------------------------------
AWS CLI commands

aws configure
aws iam list-users
----------------------------------------------------------------------------------------------------------------------------------------------------
AWS Cloudshell

allows you to use the AWS CLI within the console, so default settings are already set from your user, which makes it easier

----------------------------------------------------------------------------------------------------------------------------------------------------

Billing 

Billing dashboard shows costs breakdown

AWS Free Tier shows how much you can get for free


Budget console

Add threshold to send email when limit is getting closer

----------------------------------------------------------------------------------------------------------------------------------------------------
EC2 Fundamentals

EC2 ->  Elastic Compute Cloud
----------------------------------------------------------------------------------------------------------------------------------------------------

Launching an EC2 instance on Linux

Create AMI
Create instance (t2.micro)
Create Key Pair to login (needed id you need to SSH to access instance)
Use .pem format for Linux, Mac
Use .ppk for windows 7, 8
Choose network settings (Security Group, where traffic can come from )
Choose Storage options

----------------------------------------------------------------------------------------------------------------------------------------------------

EC2 instance types
7 different types

m5.2xlarge
m: instance class
5: generation (Versions)
2xlarge: size within the instance class


General Purpose -> balance between Compute, Memory, Networking (t2.micro is general purpose)
Compute Optimized -> Batch processing, Media transcoding, Machine learning eg.
Memory Optimized -> For large dataset processing
Storage Optimized -> used for storage-intensize tasks (Data warehousing apps)

----------------------------------------------------------------------------------------------------------------------------------------------------

Security Groups

Security groups act as firewalls for EC2 instances
They only contain Allow rules
They regulate access to ports
Can be attached to multiple instances
Locked down to specific region

Main Ports

22 = SSH
21 = FTP
22 = SFTP - upload files using SSH
80 = HTTP
443 = HTTPS
3389 = RDP
----------------------------------------------------------------------------------------------------------------------------------------------------
SSH
download key file (.pem file) created during instance creation
chmod 0400 .pem_file
ssh -i .pem_file ec2-user@{instance-ip} 

----------------------------------------------------------------------------------------------------------------------------------------------------

Private vs Public IP

IPV4: 1.160.10.240

Elastic IP -> Public IPV4 you own. Doesnt change when you restart EC2 instance
Avoid Elastic IP

Instead use a random public IP and register a DNS name to it. Or use a Load Balancer and dont use a public IP
----------------------------------------------------------------------------------------------------------------------------------------------------

Placement Groups

used to control EC2 Instance placement strategy

Group instances by Cluster (instances on same hardware / Rack), Spread (instances on different hardware in same AZ zone)
, Partition(instances on diff hardware and AZ zones)

----------------------------------------------------------------------------------------------------------------------------------------------------

ENI (Elastic Network Interfaces)

----------------------------------------------------------------------------------------------------------------------------------------------------

EBS

eLASTIC BLOCK VOLUME is a network drive that you attach to your EC2 instance
Mounted to one instance at a time
Bound to sepecific AZ 
Free tier: 30GB Free
Not physical drive, connects over network
Need to specify capacity of EBS
You get billed per capacity

Delete on Termination attribute - terminates when associated EC2 terminates
----------------------------------------------------------------------------------------------------------------------------------------------------
EBS Snapshots

Backup of EBS volume
Can copy snapshots across AZ or Region
EBS Features:
	Snapshot archive - Stores snapshot in an archive tier (75 % cheaper) but takes 24 - 72 hours to restore
	Recycle Bin - Setup rules to retain deleted snapshots (specify retention)
	Fast Snapshot Restore (FSR) - Quickly initialise snapshot (costly)
----------------------------------------------------------------------------------------------------------------------------------------------------
AMI Overview

Amazon machine image
customization of an EC2 instance - own software, OS, Config, monitoring etc..
AMI are built for specific region (can be copied across)
		Public AMI
		Your own AMI
		AWS marketplace AMI (buy a custom AMI)

AMI Process:
	Start EC2 instance
	Stop instance
	Build AMI from instance (will also create EBS snapshots)
	Launch new instances from the AMI
	
To create image from instance:
	Right click instance and choose images and templates, create image
----------------------------------------------------------------------------------------------------------------------------------------------------
EC2 instance store
its a hardware disk, its high performance, good for high throuput apps
They lose their storage if they're stopped
Good for cache, temp content
Your responsibility to backup and replicate

----------------------------------------------------------------------------------------------------------------------------------------------------

EBS Volumes

Different types:

gp2/gp3 -> General purpose SSD - can be used as boot volumes
io1 / io2 -> Highest perfromance SSD for mission critical (low latency high througput) - can be used as boot volumes
st1 -> low cost HDD for frequently accessed / high througput
sc1 ->  low cost HDD for less frequently accessed

gp3 - 3,000 IOPS and throughput of 125 MiB. can increase IOPS to 16,000 and throughput to 1,000 MIB
gp2 - can burst IOPS to 3,000

Proviosined IOP's (IO1 / IO2) - For mission critical performance 
great for database workloads - get up to 64,000 IOPS for Nitro EC2 instance, 32000 for normal EC2

HDD (st1 / sc1) - 125 GIB to 16 TIB
SC1 - BIG DATA / DATA WAREHOUSING
throughput of 500 MIB and IOPS of 500
ST1 - for cold storage , data that is infrequently accessed
Max througput of 250 MIB and IOPS of 250
----------------------------------------------------------------------------------------------------------------------------------------------------
EBS Multi Attach (Only available for the io1/io2 volumes)

allows you to attach a volume to multiple EC2 instances in the same AZ
up to 16 EC2 instances at a time
must use a file system that is cluster-aware (not XFS,EX4)
----------------------------------------------------------------------------------------------------------------------------------------------------
EBS encryption
Done automatically bu the EC2 instance (all data contained in the volume is encrypted, data in flow to the volume is encrypted)

To encrypt and unencrypted EBS:
	Create snapshot of EBS
	eNCYPT the snapshot
	Create EBS volume from the encrypted snapshot
----------------------------------------------------------------------------------------------------------------------------------------------------
EFS (ELASTIC FILE SYSTEM)
Mnagaed NFS that can be mounted on EC2 instance (i.e it can be shared file storage for multiple EC2 instances)
works with EC2 IN MULTI-az
Highly available,scalable,expensive (3xgp2) , pay per use
Only compatible with Linux AMI, not windows

EFS scale - 1000's of concurrent NFS clients, 10 GIBGrow to petabyte scale NFS automatically
Performance mode - general purpose or Max I/O (higher latency, highly parrallel, big data)
Throughput mode - Bursting ( 1 TB = 50 MiB's + BURST OF 100mIb
Provisioned - set your througput regardless of storage size )

EFS Storage 
Storage tiers - Standard and Infrequenct access 
Availibility and durability - Standard (multi AZ ) and One zone (for dev, costs less to use (over 90%)
----------------------------------------------------------------------------------------------------------------------------------------------------
ELB & ASG - Elastic Load Balancing and Auto scaling groups

Load Balancers - servers that forward traffic to multiple servers

Different types:
Application Load Balancer - HTTP, HTTPS, WEBSOCKET
NETWORK LOAD BALANCER - TCP, TLS, UDP
GATEWAY Load Balancer - Operates ate layer 3 (Network layer)
----------------------------------------------------------------------------------------------------------------------------------------------------
Application Load Balancer - layer 7
gREAT FOR MICRO SERVICES & CONTAINER BASED APPS

Network Load Balancer - Layer 4 - forward TCP & UDP traffic to your instances
Handles millions of requests per second
Less latency than ALB
NLB has 1 static IP per AZ and supports assigning Elastic IP
Not included in the free tier

Target groups - EC2 instances, IP addresses (must be private IP's)
----------------------------------------------------------------------------------------------------------------------------------------------------
Gateway load balancer
Operates at layer 3
Used to manage a fleet of 3rd party apps 
Uses firewalls, intrusion detection
Uses GENEVE protocol on port 6081

Target groups -EC2 instances, IP addresses (private )
----------------------------------------------------------------------------------------------------------------------------------------------------
Sticky Sessions

Same client is always redirected to the same instance 
Works with ALB 
Uses cookies to know which istance to send the client to
Application-based cookies - you choose name for the target group
Application cookie - generated by load balancer

Duration-based cookie - 
----------------------------------------------------------------------------------------------------------------------------------------------------
Cross-Zone Load Balancing

Each load balancer distributes evenly across  all its instances in all AZ
This can be turned off

Its enabled by default for ALB
Its disabled by default for NLB and GLB, because you would incur extra costs
----------------------------------------------------------------------------------------------------------------------------------------------------
SSL/TLS

yOU CAN MANAGE CERTS in AWS in ACM

SNI - Server Name Indication - used to specify the hostname
It solves the problem of loading multiple SSL certs onto 1 web server
The client request will include the hostname of the site it is trying to reach. The server will then know which SSL cert to use
Only works for ALB & NLB

To add a cert to a load balancer you must add a Listener 

----------------------------------------------------------------------------------------------------------------------------------------------------
Connection Draining - allows existing connections to EC2 INSTANCES to finish while it is de-registring

Its called de-registration delay for ALB & NLB

----------------------------------------------------------------------------------------------------------------------------------------------------
ASG - Auto scaling groups

The goal is to : 
	Scale out - add EC2 instances - increased load
	Scale in - remove EC2 instances - decreased load
	Auto register new instances to a load balancer
	Re-create unhealthy instances
	
Its free
----------------------------------------------------------------------------------------------------------------------------------------------------
ASG attributes

It has a launch template:
	AMI + Instance types
	EC2 user data
	EBS volumes
	Security Groups
	SSH key pair
	Roles 
	Network and subnet information
Min / Max size / inital capacity
Scaling policies
----------------------------------------------------------------------------------------------------------------------------------------------------
ASG -
Dynamic scaling policies
	Target Tracking Scaling - Simplest, example would be setting the average CPU to always stay around 40%
	Simple / Step Scaling - When a cloud watch alarm is triggered , then add 2 units or remove 2 units, depending on the alarm
	Scheduled actions - When you can anticipate an increase in the usage, you can schedule increased resources for that time, or vice versa if decreased usage expected
	
Predictive Scaling
	Continously forecasts load and schedule scaling ahead of time (AI)

Good metric sto cale on:
	CPU utilization
	RequestCountPerTarget - measure no. of request per EC2 instances

----------------------------------------------------------------------------------------------------------------------------------------------------
Amazon RDS - Relational Database Service

Managed service - Automated provisioning, backups , monitoring, upgrades included

RDS will scale storage automatically on your DB

RDS read replicas - replicates your data to up to 5 read-only databases . Reads are eventually consistent
	Important to note that Read replicas add a new endpoint with their own DNS name. Need to change the app to reference them individually

Read replicas can be setup as Multi AZ for Disaster Recovery

----------------------------------------------------------------------------------------------------------------------------------------------------
RDS Custom

Managed Oracle and Microsfot SWL with OS and database customization

Oracle doesnt support IAM

----------------------------------------------------------------------------------------------------------------------------------------------------
Amazon Aurora

Compatible with postgres and MySQL
It is AWS cloud optimized
its storage automaticlally grows in increments of 10GB, up to 128 TB
it can have 15 replicas
It stores 6 copies of your data across 3 AZ

Aurora DB cluster

It has 1 main DB for writes to the database
Load balancing is doen for all the replicas used for the reads

Aurora Serverless
	Auto scaling based on usage
	Good for infrequent, intermittent or unpredictable workloads
	Pay per second
Aurora Multi-master
	Every instance does R/W 
Global Aurora	
	Aurora Cross Region read replicas
	Aurora Global Database - 1 Primary region and it has up to 5 read-only regions (up to 16 replicas per region), replication lag is less than 1 second

----------------------------------------------------------------------------------------------------------------------------------------------------
RDS backups

Automated backups - every 5 minutes, backups for between 1 - 35 days
For LONG TERM backups, use On Demand backups
Manual DB snapshots - triggered by user

Backups can be done from a snapshot saved to S3

Aurora Database Cloning
	Create a new DB from existing one
	Faster than snapshot & restore
----------------------------------------------------------------------------------------------------------------------------------------------------
RDS security
	At-rest encyption - encypted using KMS
	In-flight encryption - TLS-ready by default, uses AWS TLS root cert client side
	IAM authentication - roles connect to your DB
	Security groups
----------------------------------------------------------------------------------------------------------------------------------------------------
RDS Proxy
 must be accessed through VPC
 Improves database effieciency

----------------------------------------------------------------------------------------------------------------------------------------------------

ElastiCache
either Redis or MemCached cluster

Elasticache security
	IAM only works with Redis
	MemCached supports SASL-based authentication

----------------------------------------------------------------------------------------------------------------------------------------------------

Route 53
	Fully managed DNS
	Domain registrar
Route 53 - Hosted zones
	Public - contains records to route traffic on internet (public domain names)
	Private - contains record to route trafic on one or more VPC
$0.50 per month per hosted zone
----------------------------------------------------------------------------------------------------------------------------------------------------
Route 53 - Records TTL

The client will cache the record so if tries to access the DNS again it doesnt have to go back to Route 53 during the TTL

----------------------------------------------------------------------------------------------------------------------------------------------------

CNAME vs Alias
	CNAME - points a hostname to any other hostname. Only for NON ROOT Domains ( aka.something.mydomain.com)
	Alias - Points a hostname to any AWS resource. Works for both NON ROOT and ROOT domains

Types of Alias targets:
	ELB
	Cloudfront distributions
	API gateway
	S3 websites
You cannot set an Alias record for an EC2 DNS name
----------------------------------------------------------------------------------------------------------------------------------------------------
Routing Policies
Simple - 
	Routes traffic to a single resource
	Can specify multiple values for the same record (Route 53 will have for example 3 IP addresses to route for that record).In this case a random selection out of the 3 will be returned
Weighted -
	Assign a weighting to each resource. This controls the % of request that go to each resource
	DNS records must have the same name and type
	Use cases: Load balancing between regions, testing new app versions
Latency -
	Redirect to the resource with the lowest latency (normally the resource closest to client)
Geolocation -
	This is different from Latency
	It is based on user Location (Country, continent etc )
	Should create a defaut location, in case there is no record for the users location
Geoproximity -
	Set bias for how much requests go to resources
	For example, create a bias which is halfway across the US. Any user request from the left of the line goes to us-west-1, any from the right goes to us-east-1
Multi-Value -
	Use when routing traffic to multiple resources
	Route 53 returns multiple values/resources
	Up to 8 healthy records are returned for each Multi-Value query
	It is not a substitute for an ELB
Failover -
	Create a Primary and Secondary record
	If the primary fails you failover to the secondary

	
----------------------------------------------------------------------------------------------------------------------------------------------------
Route 53 - Health Checks
HTTP health checks only for public resources
Types of health checkpoints:
	Monitor endpoints
	Calculated Health checks - Combines multiple checks into one health check
For Private Hosted Zones - 
	Create CloudWatch Metric and associate CloudWatch Alarm
----------------------------------------------------------------------------------------------------------------------------------------------------
Domain registrar vs DNS service
	Registrar is Godaddy, Amazon Registrar, AfterNic
	You can use Route 53 to manage DNS records which are with GoDaddy, they dont have to be registered with Amazon
	You do this by going to Route 53 and create a Public Hosted Zone
	Then update the Nameservers on your Domain registrar (GoDaddy) to use the Route 53 Name server in your zone 
----------------------------------------------------------------------------------------------------------------------------------------------------

Solution Architecture Discussion

5 pillars for a well architecured system:
	Costs
	Performance
	Reliability
	Security
	Operational Excellence
----------------------------------------------------------------------------------------------------------------------------------------------------
Instantiating Apps quickly

Use a Golden AMI - It pre-installs all dependencies, OS to allow quicker launch of app
Bootstrap using user data - User Data scripts
Hybrid - mix of Golden AMI and User Data (Elastic Benastalk)
----------------------------------------------------------------------------------------------------------------------------------------------------
Elastic Beanstalk

A template for deploying whole system (EC2, ASG, ELB, RDS etc..)
Its a managed service
	Automatically handles provisioning, load abalancing, scaling, health monitoring
We still have control over the configuration

Elastic Beanstal Components:
	Application: collection of elastic beanstalk components
	Application version: the version of your app code (jar file )
	Environment: Collection of AWS resources for specific environment (dev, nonprod,prod)

----------------------------------------------------------------------------------------------------------------------------------------------------

S3

Bucket names must be unique globally (so cant have the same name in dev and prod for example )
Buckets are stored in regions
Naming convention:
	No uppercase, no underscore
	3 -63 characters long
Max object size stored in S3 is 5TB
----------------------------------------------------------------------------------------------------------------------------------------------------
S3 Access
Bucket policy
IAM policy

----------------------------------------------------------------------------------------------------------------------------------------------------
S3 Replication

CRR - Cross Region Replication
SRR - Same Region Replication

Uses a source and destination bucket
Versioning must be enabled on both

----------------------------------------------------------------------------------------------------------------------------------------------------
Types of S3 storage

S3 Standard - general purpose
S3 Storage - Infrequenct Access - Lowere cost than Standard
S3 Glacier - Archiving / backup - price for storage + object retrieval cost
	Instant Retrieval - milisecond retrieval, minimum storage of 90 days
	Flexible retrieval - 1 - 5minutes or 3- 5 hours depending on type of retrieval, minimum storage of 90 days
	Glacier Deep - Long term storage - 12 - 48 hours for retrieval, minimum storage of 180 days
S3 Intelligent-Tiering
	Moves objects automatically based on usage
	There are no retrieval charges
----------------------------------------------------------------------------------------------------------------------------------------------------
S3 lifecycle Rules

You can specify rules which will move objects to different storage classes
Example, any image older than 60 days move to glacier storage
----------------------------------------------------------------------------------------------------------------------------------------------------
S3 - Requester Pays

This is where you specify the person requesting an object pays. 
Example , you want to share datasets with users
User must be authenticated in AWS, so they can be billed
----------------------------------------------------------------------------------------------------------------------------------------------------
S3 Event Notifications
	ObjectCreated, ObjectRemoved, ObjectRestore
Use cases: generate thumbnails of all .jpg files uploaded to S3

Amazon EventBridge - you can link to S3 and setup event rules in this resource (advanced filtering than S3 )

----------------------------------------------------------------------------------------------------------------------------------------------------
S3 Performance

Auto scales
3,500 PUT/COPY/POST/DELETE per second, 5,500 GET/HEAD requests per prefix per second

To optimize uploads:
	Multi-Part upload - only files over 5 GB. Divides file in parts and uploads in parallel and puts them back together
	Transfer Acceleration - transfers file to an AWS edge location (over public www) which then transfers to your end location (private AWS, FASTER SPEEDS)

To optimize reads:
	Byte-Range Fetches - Parallelize GETS by requesting specific byte ranges. Retrieves files in bytes in parallel
	Also if you know the information you want is say in the headers of the file. You can then just request the first 50 bytes
----------------------------------------------------------------------------------------------------------------------------------------------------
S3 Select & Glacier Select
	Uses SQL to filter for data in your object in S3
----------------------------------------------------------------------------------------------------------------------------------------------------
S3 Batch Operations
	Use S3 Inventory to get list of all object you want to perform a batch operation on
----------------------------------------------------------------------------------------------------------------------------------------------------
S3 Object Encryption
	Server Side Encryption (SSE)
		SSE-S3 - Enabled by default
		SSE-KMS - Use AWS KMS to manage encryption keys
		SSE-C - Customer provided keys
	Client Side Encryption - encrypt before uploading

SSE-S3
	Encryption type is AES-256
	Must set header to "x-amz-server-side-encyption": "AES256" when uploading file
SSE-KMS	
	Must set header to "x-amz-server-side-encyption": "aws:kms" when uploading file
	DOWNSIDE OF THIS METHOD IS THAT YOU CALL THE kms API every time you upload an item
SSE-C
	The user must send the encryption key in the HTTPS header for reads/writes
	HTTPS mandatory
Client-Side Encryption
	User must encrypt the item before uploading
	They decrypt it outside of AWS when they hae retrieved the object
Encryption in transit (SSL/TLS)
----------------------------------------------------------------------------------------------------------------------------------------------------
CORS

Cross-Origin Resource Sharing
	Doesnt allow different origins to connect (i.e http://example.com cant connect to http://other.example.com)
	You need to allow CORS in the header of the request (Access-Control-Allow-Origin)
	
How to enable CORS on S3:
	- On other bucket (destination) you want to coonect to , go to Permissions
	- Then add a CORS policy , which allows traffic from the source url
----------------------------------------------------------------------------------------------------------------------------------------------------
MFA Delete - Versioning must be enabled on the bucket. Only bucket owner can enable/disable
	Required to permantly delete an object version
Need to setup CLI with MFA to enable MFA DELETE
Then run a command which has the bucket name
----------------------------------------------------------------------------------------------------------------------------------------------------
S3 Access Logs

Logs go into a seperate S3 bucket. Do not set your monitored bucket as your logging bucket !
----------------------------------------------------------------------------------------------------------------------------------------------------

S3 - Pre-Signed URL's

Example you want to enable a specific file in a PRIVATE bucket to be accesed by a user.
You generate a pre-singed URL and send it to them, which they can then use.

To do this in console:
	Go to bucket and click the object you want to give access to
	Under Object Actions, click Share as presigned URL
----------------------------------------------------------------------------------------------------------------------------------------------------
S3 Glacier Vault Lock
	WORM (Write Once Read Many) model
	Cant be changed once written to the bucket
----------------------------------------------------------------------------------------------------------------------------------------------------

S3 - Access Points
	Allow different access points for different user groups (Finance, Sales, Marketing )
	Grant policy for R/W to /finance prefix for finance team
	Grant policy for R/W to /sales prefix for Sales team
	Each access point has its own DNS name (Internet Origin or VPC Origin) and policy
To do this:
	You have an EC2 instance in a VPC
	You create a VPC Endpoint in that VPC
	This has an endpoint policy, which connects to the Access point, which sends them to the relevant prefix in the bucket
----------------------------------------------------------------------------------------------------------------------------------------------------
S3 Object Lambda
	Use lambda function to change an object before it is retrieved by the user
	You create S3 Access Point and S3 Object Lambda Access Point

S3 Legal Hold
	Allows the prevention of an object being overwritten or deleted indefinitely and give you the ability to remove it manually
	
----------------------------------------------------------------------------------------------------------------------------------------------------

CloudFront - Content Delivery Network (CDN)

Improves read performance by caching at edge locations to improve speed for users

Cloudfront Origins:
	S3 bucket - for distributing files
	Custom Origin (HTTP) - ALB, EC2 instance, S3 website
Edge location cannot access an instance in a VPC, must be public

----------------------------------------------------------------------------------------------------------------------------------------------------
CloudFront Geo Restriction
Restrict based on location
	Allowlist
	Blocklist
----------------------------------------------------------------------------------------------------------------------------------------------------
CloudFront Pricing

more expensive in non-US locations (India, Austrailia, Japan)
Price classes:
	Price Class All: all regions
	Price Class 200: most regions but excludes most expensive ones
	Price Class 100: only the least expensive regions
----------------------------------------------------------------------------------------------------------------------------------------------------
CloudFront - Cache Invalidations
This is where you force a refresh (you get the latest copy of data in edge location and overwrite the ttl)
----------------------------------------------------------------------------------------------------------------------------------------------------
Global Accelerator
Makes use of AnyCast IP - All servers hold the same IP address and the client is routed to the nearest one
	2 Anycast IP are created for your application
	It sends traffic direcly to the edge locationsThe edge locations send the traffic to your application
Works with Elastic IP, EC2, ALB,NLB, Public or Private

Cloudfront vs Global Accelerator
They both offer protection from DDoS attacks

CloudFront is used for caching content, content is served from the edge location
Global accelerator improved performance by using AWS internal network to route traffic to the source (It does not cache content)

----------------------------------------------------------------------------------------------------------------------------------------------------

AWS Snow Family
Data migration:
	Snowcone
	Snowball Edge
	Snowmobile
Edge Computing:
	Snowcone
	Snowball Edge
These are physical devices used to migrate large amounts of data

Snowball Edge:
	Provides block storage and S3 compatible
	Edge storage optimized - 80TB of HDD capacity
	Edge compute optimized - 42TB of HDD capacity
	Physically sent to AWS to upload
	Migration size: up to petabytes
Snowcone:
	Smaller than snowball
	8TB of storage
	SSD version - 14TB of storage
	Can be physically sent to AWS Or use AWS DataSync to send data
	Migration size: up to 24TB
Snowmobile:
	1,000,000 TB's
	Gets transferred to AWS in a truck (secure, tempertare controlled)
	Migration size: up to exabytes

	
Edge Computing:
	Process data while its being created on an edge location
	An edge location is a location which may have limitied / no internet or no access to computing power (Truck on road, ship )
	
	Snowcone - 2 CPU , 4GB memory
	Snowball Edge Compute optimized - 52 CPU, 42 TB
	Snowball Edge Storage Optimized - 40 CPU, 80 TB
AWS OpsHub - used to control Snow Family devices and configure them etc..

Snowball cannot be imported directly to Glacier.
You must first import Snowball data to S3 bucket which has a Lifecycle policy attached to it, which will send data to glacier accordingly
----------------------------------------------------------------------------------------------------------------------------------------------------

Amazon FSx
Launch 3rd party file systems on AWS.
Fully managed service

Works for Windows, Lustre, NetApp, OpenZFS

Windows:
	Supports SMB protocol & Windows NTFS
	Active Directory integration, ACLs, user quotas
	Can be mounted on EC2 instances
	Scale up to 10s of GB/s, millions of IOPS, 100s PB of data
Lustre:
	distributed file system, large-scale computing
	Machine learning, High performance Computing
	Scales up to 100s GB/s, millions of IOPS
	Storage - SSD, HDD
	Integrates with S3

Deployment options:
	Scratch File System
		Temprary storage
		Data is not replicated
		High burst
		Usage - short term processing
	Persistent File System:
		Long term storage
		Data replicated in same AZ
NetApp:
	Compatible with NFS, SMB , iSCSI
	Not comptabile with FTP
	Works with Linux, windows, MacOS
	Auto scaling storage
	Snapshots, replication,data compression, data de-duplication
OpenZFS:
	compatible with NFS
	Works with Linux, windows, MacOS, EC2
----------------------------------------------------------------------------------------------------------------------------------------------------
Storage GATEWAY

Used as hybrid cloud solution for storage
Acts as a bridge between on-prem storage and cloud storage

Volume GATEWAY - used for backups of on-prem servers
	Cached Volumes - Low-latency access to most recently used data
	Stored Volumes - On-Premises data with scheduled offsite backups
----------------------------------------------------------------------------------------------------------------------------------------------------
AWS Transfer Family

FTP into / out of S3 or EFS
	FTP - unencrypted
	FTPS (SSL) encrypted in flight
	SFTP (encrypted in flight)
Pay per provisioned endpoint per hour + data transfers in GB
Usage: sharing files, public datasets
----------------------------------------------------------------------------------------------------------------------------------------------------
AWS DataSync

Move large amount of data to and from:
	On-prem to AWS - needs agent
	AWS to AWS
Can syncronize data to:
	S3
	EFS
	FSx
Replication can be scheduled
----------------------------------------------------------------------------------------------------------------------------------------------------
Storage Comparison

S3 - Object Storage
S3 Glacier - Object Archival
EBS volumes - Network storage for EC2 instance at a time
Instance storage - Physical storage for EC2 (high IOPS)
EFS - Network file system for windows servers - Multiple AZ
FSx for Windows - High performance computing linux file system
FSx for NetApp - High OS Compatibility
Fsx for OpenZFS - Managed ZFS file system
Storage gateway - S3 and FSx file gateway, Volume Gateway (mount volumes and have them backed up in cloud)
Transfer Family - FTP, FTPS, SFTP 
DataSync - Schedule data sync from on-prem to AWS
Snow Family - move large amount of data to the cloud
----------------------------------------------------------------------------------------------------------------------------------------------------
AWS Integration & Messaging
	SQS, SNS & Kinesis
Asynchronous communications - Decoupled apps
----------------------------------------------------------------------------------------------------------------------------------------------------
SQS
	Standard Queue
		Unlimited throuput, unlimited no. of messages
		default retention - 4 days, max of 14 days
		low latency
		limitation of 256KB per message sent
		at-least once delivery - Can have duplicate messages
		Best-order processing - Can also have out of order messages
SQS auto scaling -> setup cloudwath metric which will trigger cloudwatch alarm
Security - in-flight encryption using HTPPS API	
			At-rest encryption using KMS
			Client side encryption
IAM policies to regulate access
SQS Access policies- similar to S3 bucket policies

SQS Consumer POLLS for messages, not like Kafka where they subscribe
----------------------------------------------------------------------------------------------------------------------------------------------------
SQS - Message visibility timeout
	This means once a consumer gets the message it wont be visible for a period of time to other consumers, so no duplication of processing the message
	If a consumer is taking a long time to process the message, it can call the ChangeMessageVisibility API to get more time
----------------------------------------------------------------------------------------------------------------------------------------------------
SQS - Long Polling
	Consumer waits for messages to arrive if there are none in queue
	Wait time can be between 1 - 20 seconds
	Preferable to short polling
	Long polling can be set a Queue level or the individual consumer
----------------------------------------------------------------------------------------------------------------------------------------------------
SQS - FIFO (First in first out)
	Exactly one processing - Removes duplicates
	In-order processing - messages are processed in order
	limited throuput, 300 msg/s without batching, 3000 with
----------------------------------------------------------------------------------------------------------------------------------------------------
SQS with Asg - uSED TO DECOUPLE Apps
----------------------------------------------------------------------------------------------------------------------------------------------------
SNS

PUB/SUB model - like Kafka

Up to 12,500,000 subscriptions per topic
Types of subscribers:
	SQS, Lambda, Kinesis data firehose, emails,SMS,HTTPS endpoints
Types of producers:
	RDS, Lambda, S3 buckets, cloudwatch alarms

Security:
	Encryption:
		In-flight encryption using HTTPS API
		At-rest encryption using KMS
		cLIENT-Side encryption
	IAM policies
	SNS Access policies - similar to S3 bucket policies
----------------------------------------------------------------------------------------------------------------------------------------------------
SNS + SQS - Fan Out Pattern

Push once to SNS, and have SQS queues subscribe to SNS topic
Fully decoupled, no data loss
Cross region delivery, SNS in one region can send to SQS in other regions
----------------------------------------------------------------------------------------------------------------------------------------------------
SNS - Message Filtering
	JSON Policy to filter messages sent to SNS topic
----------------------------------------------------------------------------------------------------------------------------------------------------

Kinesis Overview
		Used to collec,process and analyze streaming data in real-time
		Could be logs, metrics, IoT data
Kinesis data streams - capture, process and store data streams
Kinesis data firehose - load data streams into AWS data stores
Kinesis data analytics - analyze data streams with SQL or apache flink
Kinesis video streams - capture, process and store video streams
----------------------------------------------------------------------------------------------------------------------------------------------------
Kinesis data streams	

Consists of shards, data split between shards
Producers send data into Kinesis
Types of producers:
	Apps
	Clients
	Kinesis Agent
	SDK, KPL
They send a record which consists of:
	Partition Key
	Data Blob (up to 1MB)
1 MB/sec or 1000 msg/sec per shard

Tyeps of consumers:
	Apps, Lambdas, Kinesis data firehose, Kinesis data anlytics, KCL

2 MB/sec (shared) per shard all consumers
2 MB/sec (enhanced) per shard per consumer

Retention between 1 - 365 days
Reprocess data

Capacity Modes:
	Provisioned Mode:
		Scale manually, choose amount of shards
		each shard gets 1MB/s (or 1000 records)
		each shard gets 2MB/s out
		You pay per shard per provisoned per hour
	On-demand mode:
		No need to provision or manager the capacity
		default capacity provisioned (4 MB/s in or 4000 record per second)
		Scales automatically based on previous 
		pay per stream per hor & data in/out per GB
		
Security:
	IAM polices
	Standard encryption options
	VPC endpoints available for Kinesis to acces within VPC
	Monitor using CloudTrail
----------------------------------------------------------------------------------------------------------------------------------------------------
Kinesis Data Firehose

Auto Scaling, fully managed
Typs of producers:
	Apps, Kinesis data streams, SDK, KPL, Kinesis agent, clients, AWS IoT
Types of consumers:
	Lambda function to transform data
	Batch writes to :
		AWS destinations
			S3
			AWS Redshift (copies from S3)
			Amazon OpenSearch
		3rd partner:
			Splunk, Mongo DB, New Relic etc.
		HTTP Endpoint
----------------------------------------------------------------------------------------------------------------------------------------------------
Kinesis Data Ordering vs SQS FIFO

Use partition key in Kinesis to maintain order (example fixture_id)
This ensures all related data will be in the same shard (all fixture data)

In SQS, you can use Group ID to achieve the same result

In Kinesis , you have the same amount of consumers as shards
In SQS, if you have 100 different Group Id's you can have 100 consumers consuming from SQS queue

So use SQS if you have a dynamic amount of data (dont know how much different group Id's)

----------------------------------------------------------------------------------------------------------------------------------------------------

Amazon MQ

Managed message broker service for:
	RabbitMQ, ActiveMQ
It doesnt scale as much as SQS / SNS
Amazon MQ runs on servers, can run Multi-AZ with failovers
It uses Amazon EFS to connect Active server and StandBy server
----------------------------------------------------------------------------------------------------------------------------------------------------
Docker

ECS, EKS, AWS Fargate, ECR (stores container images)
----------------------------------------------------------------------------------------------------------------------------------------------------
ECS- EC2 Launch type
You must provision & maintain the infrastructure (EC2 instance)
Each EC2 instance must run the ECS Agent

ECS - Fargate Luanch type
You do not provision the infrastructure
Its serverless
You just create task definitions

ALB reccomended to work with ECS
NLB used for high throughput / performance
ELB supported but not reccomended (doesnt work with Fargate)
----------------------------------------------------------------------------------------------------------------------------------------------------
ECS - Data Volumes (EFS)
Mount file system to ECS tasks
Fargate + EFS = Serverless

Doesnt work with S3, has to be EFS

----------------------------------------------------------------------------------------------------------------------------------------------------
ECS - Auto Scaling

Different from EC2 Auto scaling (EC2 instance level)

Target tracking - scale based on target value for a cloudwatch metric
Step scaling - based on cloudwatch alarm
Scheduled scaling - scale based on a specific date/time

----------------------------------------------------------------------------------------------------------------------------------------------------
EC2 Launch type - Auto scaling

Use ECS cluster capacity provider
	trigger a cloudwatch alarm when CPU hits a certain percentage, which will launch another instance 

----------------------------------------------------------------------------------------------------------------------------------------------------

ECS - Event Bridge

Use Event Bridge to create rules which when events get triggered will run an ECS task
It can also be scheduled instead of waiting for events to trigger

----------------------------------------------------------------------------------------------------------------------------------------------------

ECR - stores docker images 
Has private and public repositories
----------------------------------------------------------------------------------------------------------------------------------------------------
EKS - Elastic Kubernetes Service

Kubernets is cloud agnostic

EKS pods run in EKS nodes

Node types:
	Managed node groups
	Self-managed nodes
	AWS Fargate


Data Volumes supported:
	EBS, EFS, FSx for Lustre, FSx for NetApp ONTAP
----------------------------------------------------------------------------------------------------------------------------------------------------
AWS App Runner

Managed service (you get ASG, Load balancing etc..)
Makes it easy to deploy web apps or API to AWS without any aws knoledge
Auto builds and deploys the web app


----------------------------------------------------------------------------------------------------------------------------------------------------

ECS task role is the IAM Role used by ECS task itself. 
Use when your container wants to call other AWS services like S3, SQS etc.
----------------------------------------------------------------------------------------------------------------------------------------------------
EFS volume can be shared between different EC2 instances and different ECS tasks. 
Can be used as a persistent multi-AZ shared storage for your containers
----------------------------------------------------------------------------------------------------------------------------------------------------
IAM task role

Your Amazon ECS tasks can have an IAM role associated with them. 
The permissions granted in the IAM role are assumed by the containers running in the task.
----------------------------------------------------------------------------------------------------------------------------------------------------
EC2 Instance Profile - passes an IAM role to an EC2 instance. 
----------------------------------------------------------------------------------------------------------------------------------------------------

Serverless

Dont manage servers, just deploy code

Types: Lambda, DynamoDB, AWS Cognito, S3, API Gateway, SNS/SQS, Kinesis Data firehose, Step functions, Fargate, Aurora Serverless
----------------------------------------------------------------------------------------------------------------------------------------------------
AWS Lambda

Increasing RAM will also improve CPU and network

Language support:
	Node.js
	Python
	Java
	Golang
	Ruby
	C#
	Custom Runtime API (example Rust)

Lambda container image
	The container image must implement the lambda runtime API
	ECS / Fargate is still preferred for running arbitrary Docker images

Lambda integrations:
	API Gateway
	Kinesis
	DynamoDB
	S3
	CloudWatch 
	CloudFront
	SNS / SQS
	Cognito (react to user logins)

Pricing:
Pay per calls:
	Pay per request and compute time
	Free tier is 1 million lambda requests and 400,000 GBs of compute time
	$0.20 per 1 million requests thereafter 
Pay per duration:
	400,000 GB-seconds of compute time per month if free
	== 400,000 seconds if function is 1GB RAM
	== 3,200,000 seconds if function is 128 MB RAM
	After that $1.00 for 600,000 GB-seconds
----------------------------------------------------------------------------------------------------------------------------------------------------
Lambda limits

Execution:
	Memory allocation : 128 MB - 10GB (1 MB increments)
	Max execution time: 900 seconds or 15 minutes
	Env variables (4 KB)
	Disk capacity: 512 MB to 10 GB
	Concurrency executions: 1000 (can be increased)
Deployment:
	Function deployment size: compressed zip: 50 MB
	Size of uncompressed deployment(code + dependencies) : 250 MB
	Can use the /tmp directory to load other files at startup
	Size of env variables: 4KB
----------------------------------------------------------------------------------------------------------------------------------------------------
Customization at the Edge

Executing logic at the edge location
Edge Function:
	Code that is attached to CloudFront distributions
	Runs close to your users to minimize latency
2 types:
	CloudFront Functions & Lambda@Edge
Serverless

Use cases:
	website security
	A/B testing
	Real-time Image Transformation
	User tracking
	User prioritization
----------------------------------------------------------------------------------------------------------------------------------------------------
CloudFront Functions

functions written in javascript
For high-scale, latency-sensitive CDN customizations
Sub-ms startup times, millions of request/second
Used to change Viewer requests and responses

----------------------------------------------------------------------------------------------------------------------------------------------------
Lambda@Edge

functions written in Nodejs or Python
Scales to 1000s of requests per second
Author functions in 1 AWS region then cloudfront replicates to all locations

Lambda function vs Lambda@Edge
							Lambda Functions					Lambda@Edge
# of requests - 			millions per/s						thousands per/s
Max execution time			< 1ms								5-10 second
Max memory					2 MB								128 MB - 10 GB
pACKAGE SIZE - 				10 KB								1 MB - 50 MB
Network / file access		No									Yes
Access to request body		No									Yes
Pricing						Free tier, 1/6th price of edge		No free tier, charged per request & duration
CloudFront triggers			Viewer request/response				Viewer request/response & Origin request/response

Use cases:
Lambda Function												Lambda@Edge

Cache key normalization										access to body of HTTP request
Header manipulation											network access to use external services for processing
Authentication (validate tokens)							You need to use 3rd party library
----------------------------------------------------------------------------------------------------------------------------------------------------
Lambda in VPC

By default lambdas launch outside your VPC

You need to specify your VPC details when creating lambdas
Lambda will create an ENI (Elastic Network Interface) in your subnet
----------------------------------------------------------------------------------------------------------------------------------------------------
Lambda with RDS Proxy

Use RDS Proxy to manage load going into RDS
It pools and shares connections

----------------------------------------------------------------------------------------------------------------------------------------------------
Invoke Lambda from RDS & Aurora

You can trigger lambdas based on inserts into DB
Must allow outbound traffic to your lambda from within your DB
DB instance must have permissions (lambda resource-based policy & IAM policy)
----------------------------------------------------------------------------------------------------------------------------------------------------
RDS Event notifications
----------------------------------------------------------------------------------------------------------------------------------------------------
DynamoDB

Fully managed NoSQL database
Scales to massive workloads
millions of request per/s
100s of TB storage
Integrated with IAM
No maintenance or patching, always available

DynamoDB sTREAMS MUST BE ENABLED IF YOU WANT TO REPLICATE DATA ACROSS REGIONS

Standard Class and Infrequent class

Maximum size of an item in DB is 400KB

Read/Write Capacity Modes:
	Provisioned Mode (default) - for predictable workloads
		You specify the no. of reads/writes per/s
		plan capacity beforehand
		pay for provisioned RCU & WCU
		RCU and WCU are decoupled - You can increase / decrease them individually
		
	On Demand Mode
		Auto scales Read/Write capacity
		Pay for what you use, more expensive
		Great for unpredicatble loads
----------------------------------------------------------------------------------------------------------------------------------------------------
DynamoDB Accelerator (DAX)

memory-cache for dynamo
solves read congestion
the app connects to the cache, which then connects to dynamo

----------------------------------------------------------------------------------------------------------------------------------------------------
DynamoDB Stream Processing

A STREAM OF ALL MODIFICATIONS ON YOUR TABLE

Use case:
	React to changes in real-time (welcome email to users )
	Invoke lambda 
	Real time data anlytics
DynamoDB Streams								Kinesis Data Streams

24 hours retention								1 year retention
limited  #customers								high # of consumers
process using lambda triggers, KCL adapter		process lambda triggers, kinesis data anlytics,kinesis data firehose, glue streaming

----------------------------------------------------------------------------------------------------------------------------------------------------
DynamoDB backups

Continous backups using point-in-time recovery (POTR)
	backsup last 35 days
	
On-demand backups
	longer term backups - until you delete them

You can export from dynamo to S3, but POTR has to be enabled
When you export dynamo DB to S3 it is stored in json format on S3
----------------------------------------------------------------------------------------------------------------------------------------------------

API GATEWAY

AWS lambda + API gateway == No infra to manage
Support for WS protocol
create API keys, handle request throttling
Swagger / Open API 
Transform and validate requests and responses
generate SDK and API specs

----------------------------------------------------------------------------------------------------------------------------------------------------
API Gateway - Integrations

Lambda function
HTTP
AWS Service
	Expose any AWS API through the gateway

----------------------------------------------------------------------------------------------------------------------------------------------------

API Gateway - Endpoint Types

Edge-Optimized (default)
	For global clients
Regional
	When clients in same region
Private
	Only accessed within VPC
----------------------------------------------------------------------------------------------------------------------------------------------------
API Gateway Security


User AUTH:
	IAM roles
	Cognito
	Custom authorizer
Custom Domain Name HTTPS security through integration with AWS Cert Manager (ACM)
	If using Edge-Optimized endpoint, then cert must be in us-east-1
	If using Regional endpoint, the cert must be in the API Gateway region
	Must setup CNAME or A-alias record in Route 53
----------------------------------------------------------------------------------------------------------------------------------------------------

AWS Step Functions

Visual workflows to orchestrate your lambda functions
----------------------------------------------------------------------------------------------------------------------------------------------------
Amazon Cognito

Gives users an identity to interact with our web or mobile application

Cognito vs IAM - For users that sit outside AWS ('hundreds of users, mobile users') - look for these keywords

Cognito User Pools:
	Sign in functionality
	Integrate with API Gateway & ALB
	
	User features:
		simple login
		password reset
		verification
		MFA
		
	Integrations:
		API Gateway & ALB (User authenticates through Cognito and then these resources check the credentials before allowing access)

Cognito Identity Pools:
	Users have AWS credentials so they can access AWS resources directly
	Integrate with Cognito User Pools as an identity provider
	
	Users obtain temporary aws credentials
	3rd party logins
	
	Users can access AWS services directly without going through the API Gateway or ALB
	DEFAULT IAM roles for authenticated and guest users
	
	Example: User gets token from provider (Google authenticator etc..)
			 Then exchanges token for temprary aws credentials from Cognito Identity Pools
			 User can then connect directly to AWS resources
			 
	Use case:
		Row level security in DynamoDB:
			We have an IAM policy which gets the row from DB which contains the user login token details
----------------------------------------------------------------------------------------------------------------------------------------------------

Case Study examples - Blog example

Use CloudFront to make S3 globally available
Use OAC (bucket access policy) to only allow users who connect through CloudFront to access to S3
----------------------------------------------------------------------------------------------------------------------------------------------------

dIFFERENT databases

Graphs: Amazon Neptune
Search: OpenSearch
Ledge: Amazon Quantum Ledger
Time Series: Amazon TimeStream
----------------------------------------------------------------------------------------------------------------------------------------------------
RDS Summary

Managed RDS
Provisoned sizes
Auto scaling for storage
Support for Read Replicas and Multi AZ
Security - IAM, KMS , Security Groups, SSL/TLS
Automated backups with point-in-time restore - 35 days
----------------------------------------------------------------------------------------------------------------------------------------------------

Amazon Aurora Summary

Compatible API for Postgres/MySQL
Storage and Compute are seperate
data is stored in 6 replicas, across 3 AZ
Compute - cluster across multi AZ , auto scaling of Read Replicas
Same securtiy as RDS
Aurora serverless - for unpredicatble workloads
Aurora Multi-Master - for continous writes failover
Aurora Global - up to 16 DB Read instance in each region
Aurora Machine Learning - perform ML using SageMaker & Comprehend on Aurora
Aurora Database Cloning - new cluster from existing one, faster than restoring a snapshot
----------------------------------------------------------------------------------------------------------------------------------------------------
ElastiCache Summary

in-memory data store, sub-milisecond latency
Support for clustering and multi AZ
Security through IAM, KMS, security groups
Code changes in app needed to use elasticache
----------------------------------------------------------------------------------------------------------------------------------------------------
Document DB

AWS implementation BASED on MongoDB
Stores JSON data
Fully managed, multi AZ
Grows automatically
millions of requests per second
----------------------------------------------------------------------------------------------------------------------------------------------------

Amazon Neptune

Graph database
Multi AZ
Used for apps which use highly connected datasets
Great for Knowledge graphs (Wikipedia), fraus detection, social networking

----------------------------------------------------------------------------------------------------------------------------------------------------

Amazon Keyspaces (Cassandra)

NoSQL
Replicated 3 times across mulit AZ
Uses Cassandra Query Language (CQL)
----------------------------------------------------------------------------------------------------------------------------------------------------
Amazon QLDB

A ledger used for recording financial transactions
Used to review history of all changes over time
Immutable - cant be changed once entry inserted
----------------------------------------------------------------------------------------------------------------------------------------------------

Amazon Timestream

Time series database
Auto scales
Store and analyze trillions of events per day
1000s time faster and 1/10th the cost of RDS
Can perfrom time series analysis
----------------------------------------------------------------------------------------------------------------------------------------------------
Athena

Used to query data stored in S3
Supports json, csv, Avro, ORC and Parquet
Pricing - $5 per TB of data scanned
Commonly used with Amazon Quicksight for reporting/dashboards
Use cases - analytics, business insights, reporting/dashboards

Performance improvement:
	Use columnar data for cost-savings (less to scan)
	Use Glue to converts your data to Parquet or ORC
	Compress data 
	Partition datasets, add more sub folders i.e /pathToTable -> /pathToTable/housing
	Use larger files to minimize overhead
	
	Federated Query:
		Allows to run SQL queries across data stored in databses
----------------------------------------------------------------------------------------------------------------------------------------------------
Redshift Overview

OLAP - Online analytical processing (data warehousing)
10x better performance than other data warehouses, scale to PBs of data
vs Athena: faster queries / joins - Use Athena for samll ad-hoc analytical tasks

----------------------------------------------------------------------------------------------------------------------------------------------------
Redshift - Snapshots & DR

Multi-AZ for some clusters
Snapshots are point-in-time stored in S3
Automated - every 8 hours , every 5 GB or on a schedule - you set retention
Restore snapshot to different region
Snapshot is retained until you delete it
----------------------------------------------------------------------------------------------------------------------------------------------------
Loading data into Redshift

Kinesis Data Firehose - through S3 copy (Redshift copies from S3 after firehose has placed data in it)
EC2 instance - uses a JDBC driver to write to Redshift in batches

----------------------------------------------------------------------------------------------------------------------------------------------------
Redshift Spectrum

Analyze data in S3 without loading into Redshift
Run a query from a Redshift cluster
Query then executed by thousands of Redshift spectrum nodes
----------------------------------------------------------------------------------------------------------------------------------------------------
OpenSearch

Successor to ElasticSearch
Search and analytic suite use for real-time app monitoring, log analytics and website search
You can search any fields in a database
Does not support SQL
Is not serverless

----------------------------------------------------------------------------------------------------------------------------------------------------

Amazon EMR

Elastic Map Reduce

Used for Hadoop clusters (Big Data)
EMR comes bundled with Apache Spark, HBase, Presto, Flink

Use cases: data processing for Big DATA

Node types and Purchasing:
	Master Node: Manage the cluster, health, coordinating
	Core Node: Run tasks and store data
	Task Node: Just to run tasks - Spot instance
	
	Purchasing Options:
		On-demand - reliable, predictable, wont be terminated
		Reserved - cost savings
		Spot - cheaper but can be terminated, less reliable
----------------------------------------------------------------------------------------------------------------------------------------------------

Amazon Oversight

Create dashboards for BI
PER-SESSION Pricing
Integrated with RDS, Aurora, Athena, Redshift, Jira, Salesforce, teradata, custom CSV, excel,json documents

Define users and Groups (Enterprise version)
	These users dont exist in IAM
A dashboard is a read-only snapshot of an anlysis that you can share
----------------------------------------------------------------------------------------------------------------------------------------------------

AWS Glue

ETL - Extract, transform and load service

Load data between AWS services ( Cassandra to DynamoDB)

Convert into Parquet format (columnar data format) -used for performance improvement
----------------------------------------------------------------------------------------------------------------------------------------------------

Glue Data Catalog - catalog of datasets

Glue Data Crawler - combines the metadata from all your DB and can put it all into Glue
----------------------------------------------------------------------------------------------------------------------------------------------------

AWS Lake Formation

Data lake = central place to have all your data for analytical purpose
Structured and unstructerd data
Fine-grained Access Control for your applications 
Out of the box source blueprints - S3, RDS, NoSQL DB

Centralized Permissions:
	Manage what users can access from a central point
	
----------------------------------------------------------------------------------------------------------------------------------------------------

Kinesis Data Analytics

2 types: SQL and Flink

For SQL:
	Reads from Kinesis Data Streams and firehose
	Then apply SQL statements to perform real-time analytics
	
	Output can be :
		Kinesis Data Streams -> Lambda or Apps
		Data Firehose - > Then to S3 or Redshift

For Apache Flink:
	Use flink to process and analyze streaming data
	These are apps (java, scala or sql) which run Flink on AWS
	
	Can only read rom Kinesis Data Stream and Amazon MSK
----------------------------------------------------------------------------------------------------------------------------------------------------

MSK - Kafka - Alternative to Kinesis Data Stream

Data is stored on EBS volumes

You can also get MSK Serverless

----------------------------------------------------------------------------------------------------------------------------------------------------

Big Data Ingestion Pipeline
----------------------------------------------------------------------------------------------------------------------------------------------------

Machine Learning

Amazon Rekognition

Facial analysis and facial search in images and videos
Used for content moderation
Set a minimum Confidence Threshold for items for moderation
Flag sensitive content for manaul review in Amazon Augmented AI (A21)
----------------------------------------------------------------------------------------------------------------------------------------------------

Transcribe Overview

Auto convert speech to text
Identified language from audio
Ability to redact certain text or patterns (mobile numbers etc..)
----------------------------------------------------------------------------------------------------------------------------------------------------

Amazon Polly

Turn text into lifelike speech using deep learning

Lexicon & SSML
	Customize the pronunciation of words with lexicons
	Translate acronymns to full text
	Convert stylized words into proper text
	
	Generate speech from plain text or from documents using Speech Synthesis Markup Language (SSML)
		Emphasis specific words
		Add whispering sounds
----------------------------------------------------------------------------------------------------------------------------------------------------

Amazon Translate

Translate to different language
----------------------------------------------------------------------------------------------------------------------------------------------------

Amazon Lex & Connect	

Same tech that powers Alexa
ASR - convert spech to text
Help build chatbots, call centre bots

Amazon Connect:
	Receive calls , contact flows, cloud based virtual contact center
	Can integrate with other CRM systems
	No upfront payments, 80% cheaper than tradional contact center solutions
----------------------------------------------------------------------------------------------------------------------------------------------------
Amazon Comprehend

NLP
SERVERLESS
Used to find insights and relationship in text
extracts key phrases and tries to understand how positive and negative text (analyze twitter) 
----------------------------------------------------------------------------------------------------------------------------------------------------

Amazon Comprehend Medical

analyzes unstructured clinical text (docters notes, test results)
----------------------------------------------------------------------------------------------------------------------------------------------------

Amazon SageMaker

Build ML models
----------------------------------------------------------------------------------------------------------------------------------------------------
Amazon Forecast

time-series analysis 
Forecasts based on previous data
----------------------------------------------------------------------------------------------------------------------------------------------------
Amazon Kendra

Document search service
Extract answers from within a document
Natural language search capabilities

----------------------------------------------------------------------------------------------------------------------------------------------------
Amazon Personalize

Build ML-service which provides personalized recommendations
----------------------------------------------------------------------------------------------------------------------------------------------------

Textract Overview

Auto extract text , handwriting, data from documents using AI
For example getting text from application form for driver licence
Works for images, PDF's
----------------------------------------------------------------------------------------------------------------------------------------------------
Machine Learning Summary

Polly - text to audio
Lex - build conversational bots
Connect - cloud contact center
Comprehend - NLP
SageMaker - ML for devs and data scientists
Forecast - build highly accurate forecasts
Kendra - ML- powered search engine - document search
Personalize - real-time personalized recommendations
----------------------------------------------------------------------------------------------------------------------------------------------------

CloudWatch Metrics

Provided metrics for every service in AWS
mETRICS BELONG TO NAMESPACES
Dimension is an attribute of a metric (INSTANCE_ID, ENVIRONMENT, ETC..)
Up to 10 dimensions per metric
Can create Cloudwatch dashboard for metrics
Can create custom metrics

CloudWatch Metric Streams

Continually stream CloudWatch metrics to a destination of your choice - Kinesis data firehose, 3rd party (Splunk, New Relic etc.)
----------------------------------------------------------------------------------------------------------------------------------------------------

CloudWatch Logs

Can define log expiration policies
Can send logs to:
	S3
	Kinesis Data firehose
	Kinesis Data Streams
	Lambda
	OpenSearch

Cloudwatch logs Sources:
	SDK, CloudWATCH Logs, CloudWatch Unified Agent
	Elastic beanstalk
	Lambda
	API GATEWAY
	CloudTrail
	Route53
	VPC Flow logs

CloudWatch Logs Metric Filter & Insights

Can filter by expressions
Metric filters can be used to trigger CloudWatch Alarm

Export CloudWatch logs to S3:
	Log data can take up to 12 hours to become available
	API call is CreateExportTask
	No real-time

CloudWatch Logs Subscriptions

Used for real-time or near real-time analyis of CloudWatch logs
Setup subscription filter for service you want to stream log data to

CloudWatch Logs Aggregation
	Combine logs from different regions and combine them
----------------------------------------------------------------------------------------------------------------------------------------------------

CloudWatch Logs for EC2

By default, no logs from EC2 will go to Cloudwatch
Need a CloudWatch agent ATTACHED TO EC2 INSTANCE to push log files

CloudWatch Logs Agent & Unified Agent

Unified Agent is latest version.
It can collect addiotnal system-level metrics such as RAM,processes
----------------------------------------------------------------------------------------------------------------------------------------------------
CloudWatch Alarms

Alarm states:
	OK
	INSUFFICIENT_DATA
	ALARM
Period:
	Length of time in seconds to evaluate a metric
	
Alarm targets:
	Stop, Terminate , Reboot, recover EC2 instance
	Trigger Auto scaling action
	Send notification to SNS
	
CloudWatch Composite Alarms:

Combining multiple alarms
Use AND OR conditions to trigger alarms
----------------------------------------------------------------------------------------------------------------------------------------------------

Amazon EventBridge

Schedule Cron jobs (scheduled scripts) to trigger lambda functions
Event Pattern - Event rules to react to a service doing something

Types of Sources:
	EC2, CodeBuild, S3 event, Trusted Advisor, CloudTrail

EventBridge generate JSON from source data then gets sent into destinations
Types of Destinations:
	Lambda
	AWS Batch
	ECS task
	SQS, SNS, Kinesis Data streams, EC2 actions

You can archive events
You can replay events (usefull for debugging)

Schema Registry

analyze events in your bus and infer the schema
Allows you to generate code for your app that will know in advance how data is structured in the event bus
Schema can be versioned

Resource based policy:
	Manage permissions for a specific event bus
	Allow/deny events from another AWS account or AWS region
	Use case: aggregate all events from your AWS organization in a single AWS account


----------------------------------------------------------------------------------------------------------------------------------------------------
CloudWatch Container Insights

Collect, aggregate, summarie metrcis nd logs from containers
Available for:
	ECS, EKS
	Kubernetes platforms on EC2
	Fargate

----------------------------------------------------------------------------------------------------------------------------------------------------
CloudWatch Lambda Insights

Monitoring and troubleshooting solution for serverless apps running on Lambda

CloudWatch Contributor Insights

Analyze log data and see metrics for top-N contributors
Examples, find bad hosts, identify the heaviest network users
----------------------------------------------------------------------------------------------------------------------------------------------------

CloudTrail

Provides governance, compliance and audit for your AWS account
Enabled by default
Get a history of events / API calls made within ypur AWS account by:
	Console
	SDK
	CLI
	AWS Services
Can export into CloudWatch logs or S3
a TRAIL CAN BE APPLIED TO All Regions (default) or a single region

CloudTrail Events

Management Events:
	operations that are perfromed on resources in your AWS account
	Can seperate Read Evetns from Write Events
Data Events:
	By default , not logged
	FOR EXAMPLE, S3 object-level activity - GetObject on S3
Insight Events:
	Detects unusal activity in your account
	It baselines what the usual activity looks like
	You can then react when an anamoly event is captured (EventBridge event) 
	
Events Retention:
	Stored for 90 days
	To keep events longer, log them to S3 and use Athena to analyze them

Intercept API calls

cREATE ALERTS BASED ON SPECIFIC api CALL

----------------------------------------------------------------------------------------------------------------------------------------------------
AWS Config

Helps with auditing and recording compliances of your AWS Resources
Helps record configurations and changes over time
Per-Region service

Config Rules:
	AWS managed config rules
	custom config rules
		evaluate if each EC2 instance is t2.micro
	Rules can be evaluated/ triggered:
		For each config change
		And or at regular time intervals
Config Rules does not prevent actions from happening
Pricing:
	$0.003 per configuration item recorded per region
	$0.001 per config rule evaluations per region

Remediations:
	Automate remediations of non-compliant resources using SSM Automation Documents
	You can trigger an event in EventBridge if something is non-compliant (example IAM Access key is expired so delete it)
----------------------------------------------------------------------------------------------------------------------------------------------------

CloudWatch vs CloudTrail vs Config

ClouWatch:
	Performance Monitoring & dashboards
	Events & Alerting
	Log Aggregation & Analysis
CloudTrails:
	Record all API calls
Config:
	Record config changes
	Evaluate resources against compliance rules
	Get timeline of changes and compliance

----------------------------------------------------------------------------------------------------------------------------------------------------

AWS Organizations

Allows to manage multiple accounts
1 main account and as many child accounts
Consolidated billing
Discounts for overall usage

Root acount normally has only 1 Management account has full admin power
Organization Unit (OU)

Service Control Policies (SCP):
	Permissions available within the account in the OU
	Restrict what children account can and cant do

----------------------------------------------------------------------------------------------------------------------------------------------------

IAM Conditions

aws:SourceIp:
	Restrict certain IP's

aws:RequestedRegion:
	Restrcit API calls from certain regions

ec2:ResourceTag:
	Restrict based on tags

aws:MultiFactorAuthPresent:
	forces MFA use
	
s3:ListBucket:
	Bucket level permissions
s3:GetObject, s3:PutObject:
	Object level permissions

----------------------------------------------------------------------------------------------------------------------------------------------------

IAM Roles vs Resource Based Policices


When you use a role, you give up any other permissions you had.
The only permissions you have are governed by the permissions of the role

For a Resourced based policy you dont give up permissions

Amazon EventBridge - Works with both IAM and Resource based Policies

For IAM:
	EventBridge has an IAM role attached to it.
	
For Resource:
	The resources which EventBridge uses have a resource based policy which allows EventBridge

----------------------------------------------------------------------------------------------------------------------------------------------------

IAM Permission Boundaries
	Controls the maximum permissions a user can have.
	This is not a common setting
----------------------------------------------------------------------------------------------------------------------------------------------------

IAM Identity Center

Successor to AWS SSO

----------------------------------------------------------------------------------------------------------------------------------------------------

Microsoft Active Directory

Security management on Windows is basically the same in AWS

Types:
	AWS Managed AD:
		Create your own AD in AWS, manage users locally, supports MFA
		Establish trust connections with your on-prem AD
	AS Connector:
		Proxy to redirect to on-prem AD, supports MFA
		Users are managed on-premies AD
	Simple AD:
		AD-compatible managed directory on AWS
		Cannot be joined with on-prem AD
----------------------------------------------------------------------------------------------------------------------------------------------------

AWS Control Tower

Set-up and govern a multi-account AWS environment based on best practices
Uses AWS Organizations to create accounts

Benefits:
	Automate the setup
	Automate ongoing policy management using guardrails
	Detect policy violations

Guardrails:
	Provides ongoing governanace for your Control Tower environment
	Preventitive Guardrail: using SCPs
	Detective Guardrails: using AWS Config (e.g identify untagged resources)
	
----------------------------------------------------------------------------------------------------------------------------------------------------

AWS Security

KMS - kEY mANAGEMENT service

manages encryption keys
Fully integrated with IAM for authorization
Integrates with most AWS services

KMS Keys Types:
KMS Keys is the master Key
	Symmetric (AES-256 keys)
		Single encryption key that is used to Encrypt and Decrypt
	Asymmetric (RSA & ECC key pairs)
		Public and private key pair
		Use case when encryption is outside of AWS by users who cant call the KMS API
		
Types of KMS keys:
	AWS Owned Keys - free - SSE-S3, SSE-SQS, SSE-DDB - DEFAULT KEY
	AWS Manged Key - free - naming format (aws/service-name, e.g aws/rds)
	Customer managed keys created in KMS - $1 per month
	Customer imported keys - $1 per month
Automatic Key rotation:
	AWS-managed KMS key - auto every 1 year
	Customer-managed key - auto every 1 year (must be enabled)
	Imported KMS key - only manaul rotation possible using alias

KMS keys are scoped by region
You need to create snapshot and copy across to another region

KMS Key Policies:
	Similar to S3 bucket policies
	By default, if you dont create a policy everyone in your account can access KMS keys
	
Copying Snapshots across accounts:
	1 - Create a snapshot, encrypted with your own KMS key
	2 - Attach a KMS key policy
	3 - Share the encrypted snapshot
	4 - Create a copy of the snapshot, encrypt it with a CMK in your account
	5 - Create a volume from the snapshot

----------------------------------------------------------------------------------------------------------------------------------------------------

KMS Multi-Region Keys

Replicate key to multiple regions
	
KMS Multi-region are not global (Primary key + Replica keys)
Each Multi-region key is managed independently

Not reccommended

Use case:
	Encrypt in 1 region and decrypt in another region
	Global client-side encryption
	Encryption on Global DynamoDB, Global Aurora
----------------------------------------------------------------------------------------------------------------------------------------------------

S3 Replication - Encryption

Unencrypted objects and objects encrypted with SSE-S3 (Default key service) are replicated  by default
Objects encrypted with customer key are never replicated

Objects encrypted with SSE-KMS , you need to enable the option

----------------------------------------------------------------------------------------------------------------------------------------------------

AMI Sharing process encrypted via KMS

Must modify the LaunchPermission of the image to launch the image in another account
Must share the KMS Keys used to encrypt the AMI
The IAM role in the target account must have permission to Decrypt
----------------------------------------------------------------------------------------------------------------------------------------------------
SSM Parameter Store

• Secure storage for configuration and secrets
• Optional Seamless Encryption using KMS
• Serverless, scalable, durable, easy SDK
• Version tracking of configurations / secrets
• Configuration management using path & IAM
• Notifications with CloudWatch Events
• Integration with CloudFormation

SSM Parameter Store Hierarchy

• /my-department/
• my-app/
• dev/
• db-url
• db-password
• prod/
• db-url
• db-password
• other-app/
• /other-department/
• /aws/reference/secretsmanager/secret_ID_in_Secrets_Manager
• /aws/service/ami-amazon-linux-latest/amzn2-ami-hvm-x86_64-gp2

Standard and advanced parameter tiers

						Standard				Advanced

Amount of params:		10,000					100,000			
Max size of param:		4KB						8KB
Param policy:			No						Yes
Costs:					Free					Charges may apply
Storage pricing:		Free					%0.0.5 per parameter per month


Parameters Policies:
	TTL
	Can assign multiple polices at a time

----------------------------------------------------------------------------------------------------------------------------------------------------

AWS Secrets Manager

$0.40 per secret per month
$0.05 per 10,000 API calls

Used with RDS service
----------------------------------------------------------------------------------------------------------------------------------------------------

AWS Cert Manager (ACM)

Manage TLS certs
TLS used to provide in-flight encryption (HTTPS)
Cant use ACM with EC2

To use an ACM certificate with Amazon CloudFront, you must request or import the certificate in the US East (N. Virginia) region.
----------------------------------------------------------------------------------------------------------------------------------------------------

AWS WAF

PROTECTS YOUR APP FROM COOMON WEB EXPLOITS

Deploy on :
	ALB
	API GATEWAY
	Cloudfront
	AppSync graphql api
	Cognito User Pool
	
Define Web ACL - Control list -who can access
	Set up to 10,000 IP addresses
	Geo-Match (block countries)
	Protect from SQL Injection
	Rate-based rules - count occureences per IP - stop bots (DDoS protection)
	
Web ACL is Regional except for Cloudfront
A rule group is a resusable set of rules you can add to a web ACL

Use Global Accelerator to use a fixed IP and WAF on a ALB

----------------------------------------------------------------------------------------------------------------------------------------------------

AWS Shield - Protects from DDoS attack

Shield Standard:
	Free service
Shield Advanced:
	$3,000 per month
	Protects against more sophistacated attacks
	24/7 access to AWS DDoS response teams
	
----------------------------------------------------------------------------------------------------------------------------------------------------

AWS Firewall Manager


Manage rules in all accounts of an AWS Organization

• Common set of security rules
• WAF rules (Application Load Balancer, API Gateways, CloudFront)
• AWS Shield Advanced (ALB, CLB, Elastic IP, CloudFront)
• Security Groups for EC2 and ENI resources in VPC	

----------------------------------------------------------------------------------------------------------------------------------------------------

WAF vs Firewall Manager vs Shield

	Use all 3 together for full protection
	For granular protection of your resources, use WAF alone
	To use WAF across multi accounts, use Firewall Manager along with AWS WAF

----------------------------------------------------------------------------------------------------------------------------------------------------

AWS GuardDuty - DOES NOT ANALYSE CLOUDWATCH LOGS !

Uses AI to detect anamolies in your account
Analyses CloudTrail logs and events
Analyses DNS logs
Analyses Kubernetes Audit Logs

----------------------------------------------------------------------------------------------------------------------------------------------------

AWS Inspector

Provides Automated Security Assessments

For EC2 instances:
	Leverages the SSM agent
	Analyses OS against known vulvnerabilites

For Containers push to Amazon ECR:
	Assessment of containers as they are pushed

For Lambda functions:
	

Reporting & integration with AWS Security Hub
• Send findings to Amazon Event Bridge


----------------------------------------------------------------------------------------------------------------------------------------------------

Amazon Macie

Amazon Macie is a fully managed data security and data privacy service
that uses machine learning and pattern matching to discover and protect your sensitive data in AWS.
• Macie helps identify and alert you to sensitive data, such as personally identifiable information (PII)




























	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	






































































































































































































































































































































































































































































































































	
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		



























































































































































			 
			 
			 
			 
			 
			 
			 
			 
			 
			 
			 
			 
			 
			 
			 
			 
			 
			 
			 
			 
			 
			 
			 
			 
			 
			 
			 
			 
			 
			 
	





































































































































































































































































































































	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	































































	




































































































		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
		
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	





























































	





























	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	











































































































	













































































































